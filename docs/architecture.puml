@startuml
!theme plain
top to bottom direction

skinparam shadowing false
skinparam componentStyle rectangle
skinparam defaultFontSize 14

' ----------------------------
' Color palette (soft + professional)
' ----------------------------
skinparam component {
  BackgroundColor #F9FAFB
  BorderColor #374151
}

skinparam database {
  BackgroundColor #EEF2FF
  BorderColor #4338CA
}

skinparam rectangle {
  BackgroundColor #FFFFFF
  BorderColor #111827
}

skinparam arrow {
  Color #374151
  Thickness 1.4
}

' ----------------------------
' Architecture boundary
' ----------------------------
rectangle "Mutation Browser Architecture" {

  component "Structured variant data" as A #ECFEFF
  note right of A
    Generated by upstream
    bioinformatics workflows
  end note

  component "Ingestion scheduler\n(batch / event-driven)" as A1 #E0F2FE
  A --> A1

  database "PostgreSQL database" as B {
    component "Variants table" as B1
    component "Query events table" as B2
  }

  A1 --> B

  component "Flask web service" as C #F0FDF4 {
    component "Health endpoint" as C1
    component "Variants API" as C2
    component "Status API" as C3
  }

  B1 --> C

  component "RabbitMQ broker" as Q #FEF3C7

  component "Celery worker" as W #EDE9FE {
    component "Query log task" as W1
  }

  C2 --> Q : enqueue log task
  Q --> W : deliver task
  W1 --> B2 : write query event
  C3 --> B2 : read status

  component "React frontend" as D #FFF7ED {
    component "Search & browse UI" as D1
  }

  C2 --> D

  component "Clients\n(browser / users)" as E #FAF5FF
  D --> E
}

' ----------------------------
' Infrastructure & testing
' ----------------------------
component "Docker Compose" as F #F3F4F6
F ..> B
F ..> C
F ..> D
F ..> Q
F ..> W

component "API tests" as T #FEE2E2
T ..> C

@enduml
